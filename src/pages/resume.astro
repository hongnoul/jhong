---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout>
	<main class="relative h-screen overflow-hidden">
		<div
			id="pdf-bounce"
			class="fixed left-0 top-0 z-10 overflow-hidden bg-white transition-[border-color] duration-200"
		>
			<iframe
				class="h-full w-full"
				src="/JustinHong.pdf#toolbar=0&navpanes=0&scrollbar=0"
				title="Justin Hong Resume"
			></iframe>
		</div>
	</main>
</BaseLayout>

<style>
	:global(body) {
		overflow: hidden;
	}
	#pdf-bounce.is-hover {
		outline: 6px solid #4f46e5;
		outline-offset: 6px;
		cursor: pointer;
	}
</style>

<script>
	const frame = document.querySelector("#pdf-bounce");
	if (frame) {
		const isMobile = window.matchMedia("(max-width: 768px)");
		if (isMobile.matches) {
			frame.style.width = "100vw";
			frame.style.height = "100vh";
		} else {
		let speedFactor = 1;
		const setupFloat = ({
			element,
			aspect,
			maxHeightRatio,
			maxWidthRatio,
			minHeight,
			margin,
			speedX,
			speedY,
		}) => {
			let width = 0;
			let height = 0;
			let x = 0;
			let y = 0;
			let vx = speedX;
			let vy = speedY;

			const resize = () => {
				const maxHeight = window.innerHeight * maxHeightRatio;
				height = Math.max(minHeight, Math.min(maxHeight, window.innerHeight - margin));
				width = height * aspect;
				if (width > window.innerWidth * maxWidthRatio) {
					width = window.innerWidth * maxWidthRatio;
					height = width / aspect;
				}
				element.style.width = `${width}px`;
				element.style.height = `${height}px`;
				x = Math.min(Math.max(0, x), window.innerWidth - width);
				y = Math.min(Math.max(0, y), window.innerHeight - height);
			};

			const step = () => {
				x += vx * speedFactor;
				y += vy * speedFactor;

				if (x <= 0 || x + width >= window.innerWidth) {
					vx *= -1;
					x = Math.min(Math.max(0, x), window.innerWidth - width);
				}
				if (y <= 0 || y + height >= window.innerHeight) {
					vy *= -1;
					y = Math.min(Math.max(0, y), window.innerHeight - height);
				}

				element.style.transform = `translate(${x}px, ${y}px)`;
				requestAnimationFrame(step);
			};

			resize();
			window.addEventListener("resize", resize);
			requestAnimationFrame(step);
		};

		setupFloat({
			element: frame,
			aspect: 8.5 / 11,
			maxHeightRatio: 0.6,
			maxWidthRatio: 0.75,
			minHeight: 240,
			margin: 80,
			speedX: 1.4,
			speedY: 1.1,
		});
		frame.addEventListener("mouseenter", () => {
			speedFactor = 0.1;
			frame.classList.add("is-hover");
		});
		frame.addEventListener("mouseleave", () => {
			speedFactor = 1;
			frame.classList.remove("is-hover");
		});
		frame.addEventListener("click", () => {
			window.open("/JustinHong.pdf", "_blank", "noopener");
		});
		}
	}
</script>

<style>
	@media (max-width: 768px) {
		#pdf-bounce {
			width: 100vw;
			height: 100vh;
			transform: none !important;
		}
	}
</style>
