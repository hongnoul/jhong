---
import "../styles/global.css";
import { ClientRouter } from "astro:transitions";

const navItems = [
	{ label: "home", labelKo: "홈피", href: "/" },
	{ label: "experience", labelKo: "경력", href: "/experience" },
	{ label: "writing", labelKo: "수필", href: "/writing" },
	{ label: "résumé", labelKo: "이력", href: "/resume" },
];

const currentPath = Astro.url.pathname;
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<link
			rel="stylesheet"
			href="//cdn.jsdelivr.net/gh/Dalgona/neodgm-webfont@1.510/neodgm_code/style.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/galmuri/dist/galmuri.css"
		/>
		<title>Justin Hong</title>
		<ClientRouter />
	</head>
	<body>
		<script is:inline data-astro-rerun>
			const applyNavLanguage = () => {
				const useKorean = localStorage.getItem("nav-lang") === "ko";
				document
					.querySelectorAll('nav[aria-label="Primary"] a[data-label-en]')
					.forEach((link) => {
						const label = useKorean
							? link.dataset.labelKo
							: link.dataset.labelEn;
						if (label) {
							link.textContent = label;
						}
					});
			};

			document.addEventListener("astro:page-load", applyNavLanguage);
			if (document.readyState !== "loading") {
				applyNavLanguage();
			}
		</script>
		<main id="page">
			<slot />
		</main>
		<nav
			class="fixed bottom-0 left-0 right-0 z-10 flex h-[var(--nav-height)] items-center bg-transparent"
			aria-label="Primary"
		>
			<div
				class="mx-auto flex w-full max-w-[960px] items-center justify-between gap-5 px-6"
			>
				{navItems.map((item) => {
					const isActive =
						item.href === "/"
							? currentPath === "/"
							: currentPath.startsWith(item.href);
					return (
						<a
							class={`cursor-pointer bg-transparent p-0 text-xl lowercase tracking-[0.08em] text-black hover:underline hover:decoration-2 ${
								isActive ? "underline decoration-2" : ""
							}`}
							href={item.href}
							aria-current={isActive ? "page" : undefined}
							data-label-en={item.label}
							data-label-ko={item.labelKo}
						>
							{item.label}
						</a>
					);
				})}
			</div>
		</nav>

	</body>
</html>
